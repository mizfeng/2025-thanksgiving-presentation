<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>2025 曼陀劇坊 感恩節展演</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background-color: #000;
        }

        .wrapper {
            position: absolute;
            top: 0;
            left: 0;
            transform-origin: top left;
        }

        .page-container {
            position: relative;
            width: 1122px;
            height: 794px;
            overflow: hidden;
            background-color: #000;
        }

        .page-container img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            /* 等比例縮小圖片不變形 */
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
        }

        .hotspot {
            position: absolute;
            background: rgba(255, 0, 0, 0);
            /* 初始可見，便於對位 */
            border: 1px solid rgb(36, 19, 15, 0.001);
            border-radius: 8px;
            cursor: pointer;
            z-index: 1;
            /* box-shadow: 0 0 8px rgb(255, 0, 0, 0.5); */
        }

        .hotspot:hover {
            /* box-shadow: 0 0 8px rgb(255, 0, 0); */
            /* background: rgba(255, 0, 0, 0.5); */
            border-bottom: 3px solid rgb(114, 0, 0, 1);
        }

        .hotspot2 {
            position: absolute;
            background: rgba(255, 0, 0, 0);
            /* 初始可見，便於對位 */
            border: 1px solid rgb(36, 19, 15, 0.001);
            border-radius: 8px;
            cursor: pointer;
            z-index: 1;
            /* box-shadow: 0 0 8px rgb(255, 0, 0, 0.5); */
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <div class="page-container" id="container">
            <img id="bg" src="" alt="背景圖" />
            <!-- 熱區由 JS 動態插入 -->
        </div>
    </div>

    <script>
        const container = document.getElementById("container");
        const bg = document.getElementById("bg");

        function changePage(p) {
            // 載入對應圖片
            bg.src = `img/${p}.jpg`;
            // 建立熱區
            setupPage(p);
        }

        function addHotspot(x, y, w, h, targetPage, type = true) {
            const a = document.createElement("div");
            if (type) {
                a.className = "hotspot";
            } else {
                // 移除hover的效果
                a.className = "hotspot2";
            }
            a.style.left = x + "px";
            a.style.top = y + "px";
            a.style.width = w + "px";
            a.style.height = h + "px";
            a.onclick = () => changePage(targetPage);
            container.appendChild(a);
        }

        // 清除既有熱區（若有切換）
        function clearHotspots() {
            document.querySelectorAll(".hotspot").forEach((el) => el.remove());
            document.querySelectorAll(".hotspot2").forEach((el) => el.remove());
        }

        // 建立當前頁面的互動邏輯
        function setupPage(p) {
            clearHotspots();
            switch (p) {
                case "1":
                    console.log("到頁1 首頁");
                    // 首頁：左上 → Page2、人名 → Page4~11、其餘 → Page3
                    addHotspot(0, 0, 1122, 794, "3", false); // 其他區域-節目表
                    addHotspot(110, 85, 135, 140, "2"); // 左上-製作團隊
                    addHotspot(425, 405, 110, 65, "4"); // 馮德曼
                    addHotspot(580, 405, 110, 65, "5"); // 高秋華
                    addHotspot(265, 485, 110, 60, "6-1"); // 韓汝晶
                    addHotspot(425, 485, 110, 60, "7"); // 齊安平
                    addHotspot(580, 485, 110, 60, "8"); // 石鴻珍
                    addHotspot(745, 485, 110, 60, "9"); // 顧稀文
                    addHotspot(425, 570, 110, 55, "10"); // 劉祖光
                    addHotspot(580, 570, 110, 55, "11"); // 張雅君
                    break;
                case "2":
                    // 製作團隊 - 拆Part1 - 到頁21 Part2
                    addHotspot(0, 0, 1122, 794, "21", false);
                    break;
                case "3":
                    // addHotspot(380, 230, 340, 385, "1"); // 回首頁
                    addHotspot(0, 0, 1122, 794, "1", false);
                    addHotspot(110, 270, 250, 80, "12"); // 掛画
                    addHotspot(110, 360, 250, 80, "13"); // 四郎探母-坐宮
                    addHotspot(110, 450, 250, 80, "14"); // 穆桂英-捧印
                    addHotspot(110, 540, 250, 80, "15"); // 龍鳳閣
                    addHotspot(750, 270, 250, 80, "16"); // 李陵碑-碰碑
                    addHotspot(750, 360, 250, 80, "17"); // 白蛇傳-斷橋
                    addHotspot(750, 450, 250, 80, "18"); // 爛柯山-痴夢
                    addHotspot(750, 540, 250, 80, "19"); // 法場換子
                    break;
                case "20":
                    // 指導單位 - 回首頁
                    addHotspot(0, 0, 1122, 794, "1", false);
                    break;
                case "21":
                    // 製作團隊 Part - 到頁20 指導單位
                    addHotspot(0, 0, 1122, 794, "20", false);
                    break;
                default:
                    if (p == "6-1") {
                        // 如果是韓汝晶第一頁，到第二頁
                        addHotspot(0, 0, 1122, 794, "6-2", false);
                    } else if (p == "6-2") {
                        // 如果是韓汝晶第二頁，回到首頁
                        addHotspot(0, 0, 1122, 794, "1", false);
                    } else if (Number(p) >= 4 && Number(p) <= 11) {
                        // 人名頁面：回首頁
                        addHotspot(0, 0, 1122, 794, "1", false);
                    } else if (Number(p) >= 12 && Number(p) <= 19) {
                        // 節目頁面：回節目表
                        addHotspot(0, 0, 1122, 794, "3", false);
                    }
            }
        }

        // 預先載入所有 21 張圖片
        function preloadAllImages() {
            for (let i = 1; i <= 20; i++) {
                if (i == 6) {
                    // 韓汝晶的兩張圖片，特例處理
                    const img = new Image();
                    img.src = `img/6-1.jpg`;
                    img.src = `img/6-2.jpg`;
                } else {
                    const img = new Image();
                    img.src = `img/${i}.jpg`;
                }
            }
        }

        function scaleContainerToScreen() {
            const wrapper = document.querySelector('.wrapper');
            const screenHeight = screen.height;
            const screenWidth = screen.width;
            const baseHeight = 794; // 頁面原始高度
            const baseWidth = 1122; // 頁面原始寬度
            const scale = Math.min(screenWidth / baseWidth, screenHeight / baseHeight) * 0.95;
            wrapper.style.transform = `scale(${scale})`;
            wrapper.style.left = `${(screenWidth - baseWidth * scale) / 2}px`;
            wrapper.style.top = `${(screenHeight - baseHeight * scale) / 2 - 50}px`;
        }

        window.addEventListener('resize', scaleContainerToScreen);
        window.addEventListener('orientationchange', scaleContainerToScreen);

        const urlPage = new URLSearchParams(location.search).get("page") || "1";
        changePage(urlPage);
        scaleContainerToScreen();
        preloadAllImages();
    </script>
</body>

</html>